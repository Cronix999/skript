-- Load required libraries with error handling
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local success, AimbotScript
success, AimbotScript = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/Exunys/Aimbot-V2/main/Resources/Scripts/Raw%20Main.lua"))()
end)
if not success then
    warn("Failed to load Aimbot script. Using fallback implementation.")
    AimbotScript = {} -- Fallback implementation
end

-- ESP Fix: Load the ESP library with error handling
local ESP
success, ESP = pcall(function()
    return loadstring(game:HttpGet("https://kiriot22.com/releases/ESP.lua"))()
end)
if not success then
    warn("Failed to load ESP library. Using fallback implementation.")
    ESP = {
        Toggle = function(state) end,
        Boxes = false,
        Names = false,
        Tracers = false,
        TeamColor = false
    }
else
    ESP:Toggle(false)
    ESP.Boxes = false
    ESP.Names = false
    ESP.Tracers = false
    ESP.TeamColor = false
end

-- Initialize Window with black and red theme
local Window = Fluent:CreateWindow({
    Title = "Evade" .. (Fluent.Version or ""),
    SubTitle = "Enhanced UI Experience",
    TabWidth = 170,
    Size = UDim2.fromOffset(650, 520),
    Acrylic = false,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.J,
    TextSize = 18,
})

-- Custom black and red theme
Fluent:SetTheme({
    Background = Color3.fromRGB(15, 15, 15),
    Accent = Color3.fromRGB(255, 0, 0),
    LightContrast = Color3.fromRGB(30, 30, 30),
    DarkContrast = Color3.fromRGB(10, 10, 10),  
    TextColor = Color3.fromRGB(255, 255, 255),
    InlineColor = Color3.fromRGB(80, 0, 0),
})

-- Define Silent Aim Settings - FIXED to not miss shots
getgenv().SilentAim = {
    Enabled = false,
    FOV = 100,
    ShowFOV = true,
    FOVColor = Color3.fromRGB(255, 0, 0),
    HitPart = "Head",
    TeamCheck = false,
    WallCheck = false,
    Prediction = 0.25, -- Increased prediction for fewer misses
    HitChance = 100, -- 100% hit chance by default
    TargetLock = false -- New feature: target lock
}

-- Define Trigger Bot Settings - FIXED implementation
getgenv().TriggerBot = {
    Enabled = false,
    Delay = 0.05, -- Reduced delay for better responsiveness
    TeamCheck = false,
    HoldTime = 0.15 -- Longer hold time for better hit registration
}

-- Define Movement Settings - Enhanced for better PvP
getgenv().Movement = {
    SpeedEnabled = false,
    SpeedMultiplier = 2,
    JumpEnabled = false, -- New feature: jump power
    JumpMultiplier = 1.5
}

-- New Anti-Aim Settings for PvP
getgenv().AntiAim = {
    Enabled = false,
    SpinSpeed = 5, -- How fast to spin
    YawOffset = 0.5 -- Head offset
}

-- Initialize Aimbot Settings
if not getgenv().Aimbot then
    getgenv().Aimbot = {
        Settings = {
            Enabled = false,
            TeamCheck = false,
            WallCheck = false,
            Sensitivity = 0.5,
            TargetPart = "Head",
            VisibleCheck = false
        },
        FOVSettings = {
            Enabled = false,
            Amount = 100,
            Color = Color3.fromRGB(255, 0, 0),
            Filled = false,
            Transparency = 0.5
        }
    }
end

-- Define Tabs
local Tabs = {
    Info = Window:AddTab({ Title = "Info", Icon = "info" }),
    Aim = Window:AddTab({ Title = "Aim", Icon = "crosshair" }),
    SilentAim = Window:AddTab({ Title = "Silent Aim", Icon = "target" }),
    TriggerBot = Window:AddTab({ Title = "TriggerBot", Icon = "zap" }),
    Visuals = Window:AddTab({ Title = "Visuals", Icon = "eye" }),
    ESP = Window:AddTab({ Title = "ESP", Icon = "search" }),
    Player = Window:AddTab({ Title = "Player", Icon = "user" }),
    AntiAim = Window:AddTab({ Title = "Anti-Aim", Icon = "shield" }), -- New tab
    Misc = Window:AddTab({ Title = "Misc", Icon = "settings" }),
    UI = Window:AddTab({ Title = "UI", Icon = "paintbrush" })
}

-- Add Information to Info Tab
Tabs.Info:AddParagraph({
    Title = "Evade Script",
    Content = "Press 'J' to toggle the menu. Fixed Silent Aim and TriggerBot. Added new PvP features!",
})

-- Notify when the script is loaded
Fluent:Notify({
    Title = "Evade Script Loaded",
    Content = "Fixed Silent Aim and TriggerBot with new PvP features!",
    Duration = 5,
})

-- Aim Tab Settings
Tabs.Aim:AddToggle("AimbotToggle", {
    Title = "Enable Aimbot",
    Default = false,
    Callback = function(state)
        getgenv().Aimbot.Settings.Enabled = state
    end
})

Tabs.Aim:AddDropdown("AimbotPart", {
    Title = "Target Part",
    Values = {"Head", "Torso", "Left Arm", "Right Arm", "Left Leg", "Right Leg"},
    Multi = false,
    Default = "Head",
    Callback = function(value)
        getgenv().Aimbot.Settings.TargetPart = value
    end
})

Tabs.Aim:AddSlider("AimbotFOV", {
    Title = "FOV Size",
    Default = 100,
    Min = 50,
    Max = 500,
    Rounding = 0,
    Callback = function(value)
        getgenv().Aimbot.FOVSettings.Amount = value
    end
})

Tabs.Aim:AddSlider("AimbotSmoothing", {
    Title = "Smoothing",
    Default = 0.5,
    Min = 0,
    Max = 1,
    Rounding = 2,
    Callback = function(value)
        getgenv().Aimbot.Settings.Sensitivity = value
    end
})

Tabs.Aim:AddToggle("WallCheck", {
    Title = "Wall Check",
    Default = false,
    Callback = function(state)
        getgenv().Aimbot.Settings.WallCheck = state
    end
})

-- Silent Aim Tab - FIXED implementation
Tabs.SilentAim:AddToggle("SilentAimToggle", {
    Title = "Enable Silent Aim",
    Default = false,
    Callback = function(state)
        getgenv().SilentAim.Enabled = state
    end
})

Tabs.SilentAim:AddDropdown("SilentAimPart", {
    Title = "Target Part",
    Values = {"Head", "Torso", "Random"},
    Multi = false,
    Default = "Head",
    Callback = function(value)
        getgenv().SilentAim.HitPart = value
    end
})

-- New target lock feature for silent aim
Tabs.SilentAim:AddToggle("TargetLock", {
    Title = "Target Lock (Better Accuracy)",
    Default = false,
    Callback = function(state)
        getgenv().SilentAim.TargetLock = state
    end
})

Tabs.SilentAim:AddSlider("SilentAimFOV", {
    Title = "FOV Size",
    Default = 100,
    Min = 50,
    Max = 500,
    Rounding = 0,
    Callback = function(value)
        getgenv().SilentAim.FOV = value
    end
})

Tabs.SilentAim:AddToggle("SilentAimFOVVisible", {
    Title = "Show FOV Circle",
    Default = true,
    Callback = function(state)
        getgenv().SilentAim.ShowFOV = state
        if SilentAimCircle then
            SilentAimCircle.Visible = state and getgenv().SilentAim.Enabled
        end
    end
})

Tabs.SilentAim:AddButton({
    Title = "Toggle FOV Visibility",
    Callback = function()
        getgenv().SilentAim.ShowFOV = not getgenv().SilentAim.ShowFOV
        if SilentAimCircle then
            SilentAimCircle.Visible = getgenv().SilentAim.ShowFOV and getgenv().SilentAim.Enabled
        end
        Fluent:Notify({
            Title = "FOV Visibility",
            Content = getgenv().SilentAim.ShowFOV and "FOV Circle is now visible" or "FOV Circle is now hidden",
            Duration = 2,
        })
    end
})

Tabs.SilentAim:AddColorpicker("SilentAimFOVColor", {
    Title = "FOV Color",
    Default = Color3.fromRGB(255, 0, 0),
    Callback = function(value)
        getgenv().SilentAim.FOVColor = value
    end
})

Tabs.SilentAim:AddToggle("SilentAimWallCheck", {
    Title = "Wall Check",
    Default = false,
    Callback = function(state)
        getgenv().SilentAim.WallCheck = state
    end
})

Tabs.SilentAim:AddSlider("SilentAimHitChance", {
    Title = "Hit Chance (%)",
    Default = 100,
    Min = 0,
    Max = 100,
    Rounding = 0,
    Callback = function(value)
        getgenv().SilentAim.HitChance = value
    end
})

Tabs.SilentAim:AddSlider("SilentAimPrediction", {
    Title = "Prediction Value",
    Default = 0.25, -- Increased for better hit rate
    Min = 0,
    Max = 0.5,
    Rounding = 3,
    Callback = function(value)
        getgenv().SilentAim.Prediction = value
    end
})

-- TriggerBot Tab - FIXED implementation
Tabs.TriggerBot:AddToggle("TriggerBotToggle", {
    Title = "Enable Trigger Bot",
    Default = false,
    Callback = function(state)
        getgenv().TriggerBot.Enabled = state
    end
})

Tabs.TriggerBot:AddSlider("TriggerBotDelay", {
    Title = "Delay (seconds)",
    Default = 0.05, -- Reduced for better responsiveness
    Min = 0,
    Max = 0.5,
    Rounding = 2,
    Callback = function(value)
        getgenv().TriggerBot.Delay = value
    end
})

Tabs.TriggerBot:AddSlider("TriggerBotHoldTime", {
    Title = "Hold Time (seconds)",
    Default = 0.15, -- Increased for better registration
    Min = 0.01,
    Max = 0.5,
    Rounding = 2,
    Callback = function(value)
        getgenv().TriggerBot.HoldTime = value
    end
})

Tabs.TriggerBot:AddToggle("TriggerBotTeamCheck", {
    Title = "Team Check",
    Default = false,
    Callback = function(state)
        getgenv().TriggerBot.TeamCheck = state
    end
})

-- Visuals Tab
Tabs.Visuals:AddColorpicker("FOVColor", {
    Title = "FOV Color",
    Default = Color3.fromRGB(255, 0, 0),
    Callback = function(value)
        getgenv().Aimbot.FOVSettings.Color = value
    end
})

Tabs.Visuals:AddToggle("FOVFilled", {
    Title = "FOV Filled",
    Default = false,
    Callback = function(state)
        getgenv().Aimbot.FOVSettings.Filled = state
    end
})

Tabs.Visuals:AddSlider("FOVTransparency", {
    Title = "FOV Transparency",
    Default = 0.5,
    Min = 0,
    Max = 1,
    Rounding = 2,
    Callback = function(value)
        getgenv().Aimbot.FOVSettings.Transparency = value
    end
})

Tabs.Visuals:AddSlider("CameraFOV", {
    Title = "Camera FOV",
    Default = 70,
    Min = 60,
    Max = 120,
    Rounding = 0,
    Callback = function(value)
        pcall(function()
            game:GetService("Workspace").CurrentCamera.FieldOfView = value
        end)
    end
})

-- Player Tab - Enhanced with more movement options
Tabs.Player:AddToggle("SpeedHackToggle", {
    Title = "Enable Speed Hack",
    Default = false,
    Callback = function(state)
        getgenv().Movement.SpeedEnabled = state
        if state then
            Fluent:Notify({
                Title = "Speed Hack Enabled",
                Content = "Your character will now move faster!",
                Duration = 2,
            })
        else
            pcall(function()
                if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
                    game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 16
                end
            end)
        end
    end
})

Tabs.Player:AddSlider("SpeedMultiplier", {
    Title = "Speed Multiplier",
    Default = 2,
    Min = 1,
    Max = 10,
    Rounding = 1,
    Callback = function(value)
        getgenv().Movement.SpeedMultiplier = value
    end
})

-- New Jump Power feature
Tabs.Player:AddToggle("JumpHackToggle", {
    Title = "Enable Jump Hack",
    Default = false,
    Callback = function(state)
        getgenv().Movement.JumpEnabled = state
        if state then
            Fluent:Notify({
                Title = "Jump Hack Enabled",
                Content = "Your character will now jump higher!",
                Duration = 2,
            })
        else
            pcall(function()
                if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid") then
                    game.Players.LocalPlayer.Character.Humanoid.JumpPower = 50
                end
            end)
        end
    end
})

Tabs.Player:AddSlider("JumpMultiplier", {
    Title = "Jump Multiplier",
    Default = 1.5,
    Min = 1,
    Max = 5,
    Rounding = 1,
    Callback = function(value)
        getgenv().Movement.JumpMultiplier = value
    end
})

-- New button for instant respawn
Tabs.Player:AddButton({
    Title = "Instant Respawn",
    Callback = function()
        pcall(function()
            if game.Players.LocalPlayer.Character then
                game.Players.LocalPlayer.Character:BreakJoints()
            end
        end)
    end
})

-- New AntiAim Tab for PvP
Tabs.AntiAim:AddToggle("AntiAimToggle", {
    Title = "Enable Anti-Aim",
    Default = false,
    Callback = function(state)
        getgenv().AntiAim.Enabled = state
        if state then
            Fluent:Notify({
                Title = "Anti-Aim Enabled",
                Content = "Makes you harder to hit!",
                Duration = 2,
            })
        end
    end
})

Tabs.AntiAim:AddSlider("SpinSpeed", {
    Title = "Spin Speed",
    Default = 5,
    Min = 1,
    Max = 20,
    Rounding = 1,
    Callback = function(value)
        getgenv().AntiAim.SpinSpeed = value
    end
})

Tabs.AntiAim:AddSlider("YawOffset", {
    Title = "Yaw Offset",
    Default = 0.5,
    Min = 0,
    Max = 1,
    Rounding = 1,
    Callback = function(value)
        getgenv().AntiAim.YawOffset = value
    end
})

-- ESP Tab
Tabs.ESP:AddToggle("ESPToggle", {
    Title = "Enable ESP",
    Default = false,
    Callback = function(state)
        pcall(function() 
            ESP:Toggle(state) 
        end)
    end
})

Tabs.ESP:AddToggle("ESPBoxes", {
    Title = "Show Boxes",
    Default = false,
    Callback = function(state)
        pcall(function() 
            ESP.Boxes = state 
        end)
    end
})

Tabs.ESP:AddToggle("ESPNames", {
    Title = "Show Names",
    Default = false,
    Callback = function(state)
        pcall(function() 
            ESP.Names = state 
        end)
    end
})

Tabs.ESP:AddToggle("ESPTracers", {
    Title = "Show Tracers",
    Default = false,
    Callback = function(state)
        pcall(function() 
            ESP.Tracers = state 
        end)
    end
})

Tabs.ESP:AddColorpicker("ESPColor", {
    Title = "ESP Color",
    Default = Color3.fromRGB(255, 0, 0),
    Callback = function(value)
        pcall(function() 
            ESP.Color = value 
        end)
    end
})

-- Misc Tab
Tabs.Misc:AddButton({
    Title = "Rejoin Game",
    Callback = function()
        pcall(function()
            game:GetService("TeleportService"):Teleport(game.PlaceId, game.Players.LocalPlayer)
        end)
    end
})

Tabs.Misc:AddButton({
    Title = "Copy Discord",
    Callback = function()
        pcall(function()
            setclipboard("https://discord.gg/evadescript")
        end)
        Fluent:Notify({
            Title = "Discord Link Copied",
            Content = "Discord link has been copied to clipboard!",
            Duration = 3,
        })
    end
})

-- UI Customization Tab
Tabs.UI:AddColorpicker("BackgroundColor", {
    Title = "Background Color",
    Default = Color3.fromRGB(15, 15, 15),
    Callback = function(value)
        pcall(function()
            Fluent:SetThemeColor("Background", value)
        end)
    end
})

Tabs.UI:AddColorpicker("AccentColor", {
    Title = "Accent Color",
    Default = Color3.fromRGB(255, 0, 0),
    Callback = function(value)
        pcall(function()
            Fluent:SetThemeColor("Accent", value)
        end)
    end
})

-- Create Silent Aim FOV circle with error handling
local SilentAimCircle
success, SilentAimCircle = pcall(function()
    local circle = Drawing.new("Circle")
    circle.Visible = getgenv().SilentAim.ShowFOV and getgenv().SilentAim.Enabled
    circle.Radius = getgenv().SilentAim.FOV
    circle.Color = getgenv().SilentAim.FOVColor
    circle.Thickness = 1
    circle.Filled = false
    circle.Transparency = 1
    return circle
end)

if not success then
    warn("Failed to create FOV circle. Drawing library may not be supported.")
    SilentAimCircle = {
        Visible = false,
        Position = Vector2.new(0, 0),
        Radius = 0,
        Color = Color3.fromRGB(255, 0, 0)
    }
end

-- Variables for target lock feature
local LockedTarget = nil
local LockedHitPart = nil

-- GetClosestPlayerToMouseSilent function with error handling
local function GetClosestPlayerToMouseSilent()
    local Target = nil
    local MaxDistance = getgenv().SilentAim.FOV
    
    -- Check hit chance
    if math.random(0, 100) > getgenv().SilentAim.HitChance then
        return nil
    end
    
    pcall(function()
        local Players = game:GetService("Players")
        local LocalPlayer = Players.LocalPlayer
        local Mouse = LocalPlayer:GetMouse()
        local Camera = workspace.CurrentCamera
        
        for _, Player in pairs(Players:GetPlayers()) do
            if Player ~= LocalPlayer then
                if not getgenv().SilentAim.TeamCheck or Player.Team ~= LocalPlayer.Team then
                    local Character = Player.Character
                    if Character and Character:FindFirstChild("Humanoid") and Character.Humanoid.Health > 0 and Character:FindFirstChild("HumanoidRootPart") then
                        local HitPart = Character:FindFirstChild(getgenv().SilentAim.HitPart) or Character:FindFirstChild("HumanoidRootPart")
                        if HitPart then
                            local ScreenPoint = Camera:WorldToScreenPoint(HitPart.Position)
                            local VectorDistance = (Vector2.new(Mouse.X, Mouse.Y) - Vector2.new(ScreenPoint.X, ScreenPoint.Y)).Magnitude
                            
                            if VectorDistance < MaxDistance then
                                if getgenv().SilentAim.WallCheck then
                                    -- Simple wall check with increased raycast
                                    local ray = Ray.new(Camera.CFrame.Position, (HitPart.Position - Camera.CFrame.Position).Unit * 2000)
                                    local hit, hitPosition = workspace:FindPartOnRayWithIgnoreList(ray, {Character, LocalPlayer.Character})
                                    if hit and hit:IsDescendantOf(Character) then
                                        MaxDistance = VectorDistance
                                        Target = Player
                                    end
                                else
                                    MaxDistance = VectorDistance
                                    Target = Player
                                end
                            end
                        end
                    end
                end
            end
        end
    end)
    
    return Target
end

-- Update FOV circle position on each frame and handle other features
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = workspace.CurrentCamera

-- Safe RunService connection with error handling
pcall(function()
    RunService.RenderStepped:Connect(function()
        -- Update Silent Aim FOV Circle
        pcall(function()
            if SilentAimCircle then
                SilentAimCircle.Position = Vector2.new(Mouse.X, Mouse.Y + 36)
                SilentAimCircle.Radius = getgenv().SilentAim.FOV
                SilentAimCircle.Visible = getgenv().SilentAim.ShowFOV and getgenv().SilentAim.Enabled
                SilentAimCircle.Color = getgenv().SilentAim.FOVColor
            end
        end)
        
        -- Handle Speed Hack
        pcall(function()
            if getgenv().Movement.SpeedEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                LocalPlayer.Character.Humanoid.WalkSpeed = 16 * getgenv().Movement.SpeedMultiplier
            end
        end)
        
        -- Handle Jump Hack
        pcall(function()
            if getgenv().Movement.JumpEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
                LocalPlayer.Character.Humanoid.JumpPower = 50 * getgenv().Movement.JumpMultiplier
            end
        end)
        
        -- Handle Anti-Aim (spinning)
        pcall(function()
            if getgenv().AntiAim.Enabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                local currentTime = tick()
                local angle = (currentTime * getgenv().AntiAim.SpinSpeed) % (2 * math.pi)
                
                LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(
                    LocalPlayer.Character.HumanoidRootPart.Position
                ) * CFrame.Angles(0, angle, 0) * CFrame.Angles(getgenv().AntiAim.YawOffset, 0, 0)
            end
        end)
        
        -- Update locked target if target lock is enabled
        pcall(function()
            if getgenv().SilentAim.Enabled and getgenv().SilentAim.TargetLock then
                if not LockedTarget or not LockedTarget.Character or not LockedTarget.Character:FindFirstChild("Humanoid") or LockedTarget.Character.Humanoid.Health <= 0 then
                    LockedTarget = GetClosestPlayerToMouseSilent()
                    if LockedTarget and LockedTarget.Character then
                        if getgenv().SilentAim.HitPart == "Random" then
                            local parts = {"Head", "UpperTorso", "LowerTorso", "LeftUpperArm", "RightUpperArm", "LeftLowerLeg", "RightLowerLeg"}
                            LockedHitPart = LockedTarget.Character:FindFirstChild(parts[math.random(1, #parts)]) or LockedTarget.Character:FindFirstChild("HumanoidRootPart")
                        else
                            LockedHitPart = LockedTarget.Character:FindFirstChild(getgenv().SilentAim.HitPart) or LockedTarget.Character:FindFirstChild("HumanoidRootPart")
                        end
                    end
                end
            else
                LockedTarget = nil
                LockedHitPart = nil
            end
        end)
    end)
end)

-- FIXED TriggerBot implementation with direct mouse control
local TriggerBotRunning = false
local function TriggerBotCheck()
    if TriggerBotRunning or not getgenv().TriggerBot.Enabled then return end
    TriggerBotRunning = true
    
    pcall(function()
        local Target = Mouse.Target
        if Target and Target.Parent then
            local Player = Players:GetPlayerFromCharacter(Target.Parent)
            if Player and Player ~= LocalPlayer then
                if not getgenv().TriggerBot.TeamCheck or Player.Team ~= LocalPlayer.Team then
                    task.wait(getgenv().TriggerBot.Delay)
                    -- Check if mouse1press is available, otherwise use alternative
                    if mouse1press then
                        mouse1press()
                        task.wait(getgenv().TriggerBot.HoldTime)
                        mouse1release()
                    else
                        -- Alternative implementation if mouse1press not available
                        local VirtualUser = game:GetService("VirtualUser")
                        VirtualUser:Button1Down(Vector2.new(Mouse.X, Mouse.Y))
                        task.wait(getgenv().TriggerBot.HoldTime)
                        VirtualUser:Button1Up(Vector2.new(Mouse.X, Mouse.Y))
                    end
                end
            end
        end
    end)
    
    task.wait(0.05) -- Short cooldown to prevent excessive firing
    TriggerBotRunning = false
end

-- Connect TriggerBot to mouse movement with error handling
pcall(function()
    Mouse.Move:Connect(function()
        if getgenv().TriggerBot.Enabled then
            TriggerBotCheck()
        end
    end)
end)

-- FIXED Silent Aim Hook - Improved to not miss shots
pcall(function()
    local oldNamecall
    oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
        local args = {...}
        local method = getnamecallmethod()
        
        if getgenv().SilentAim.Enabled and (method == "FireServer" or method == "InvokeServer" or method == "FindPartOnRayWithIgnoreList") and self.Name and self.Name:match("Remote") then
            local targetPlayer = nil
            local targetHitPart = nil
            
            -- Use locked target if available, otherwise get closest player
            if getgenv().SilentAim.TargetLock and LockedTarget and LockedHitPart then
                targetPlayer = LockedTarget
                targetHitPart = LockedHitPart
            else
                targetPlayer = GetClosestPlayerToMouseSilent()
                if targetPlayer and targetPlayer.Character then
                    if getgenv().SilentAim.HitPart == "Random" then
                        local parts = {"Head", "UpperTorso", "LowerTorso", "LeftUpperArm", "RightUpperArm", "LeftLowerLeg", "RightLowerLeg"}
                        targetHitPart = targetPlayer.Character:FindFirstChild(parts[math.random(1, #parts)]) or targetPlayer.Character:FindFirstChild("HumanoidRootPart")
                    else
                        targetHitPart = targetPlayer.Character:FindFirstChild(getgenv().SilentAim.HitPart) or targetPlayer.Character:FindFirstChild("HumanoidRootPart")
                    end
                end
            end
            
            if targetPlayer and targetHitPart then
                -- Modify arguments to target the hitPart with improved precision
                for i, v in pairs(args) do
                    if typeof(v) == "Vector3" then
                        -- More accurate prediction
                        args[i] = targetHitPart.Position + (targetHitPart.Velocity * getgenv().SilentAim.Prediction)
                    elseif typeof(v) == "CFrame" then
                        args[i] = CFrame.
